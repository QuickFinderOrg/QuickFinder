@page
@model TestModel
@using Domain.DiscordDomain
@inject DiscordService discord
@{
    ViewData["Title"] = "Test";
    var headers = HttpContext.Request.Headers.Select(h => $"{h.Key}: {h.Value}");
}

<h2>Test</h2>
@($"{HttpContext.Request.Scheme}://{HttpContext.Request.Host}{HttpContext.Request.Path}{HttpContext.Request.QueryString}")

<details title="Headers">
    <summary>Headers</summary>

    @foreach (var val in headers)
    {
        <p>@val</p>
    }
</details>

<form method="post">
    <button type="submit">TEST</button>
</form>
<p>@Model.TestResult</p>
<p>Current Timestamp: @DateTime.Now</p>

@foreach (var server in await discord.GetServerList())
{
    <p>@server.Name (@server.Id)</p>
}


@foreach (var channel in discord.GetChannels())
{
    <div style="display: flex;">
        <p>@channel.Name (@channel.Id) @channel.Category</p>
        <form method="post" asp-page-handler="DeleteChannel" asp-route-id="@channel.Id">
            <button type="submit">
                X
            </button>
        </form>
        <form method="post" asp-page-handler="SetChannelPermissions" asp-route-id="@channel.Id">
            <button type="submit">
                Perms
            </button>
        </form>
    </div>

}
